<section class="agent-section" id="agents">
    <h2 class="section-title">Our Expert Agents</h2>
    <div class="agent-profiles">
        <!-- Agent 1 -->
        <div class="agent-card">
            <img src="agent1.jpg" alt="Agent John" class="agent-photo">
            <h3>John Smith</h3>
            <p>Senior Property Consultant</p>
            <p>15+ Years Experience</p>
            <button class="search-btn" onclick="openContactModal('John Smith', 'johnsmith@example.com')">Contact Agent</button>
        </div>
        
        <!-- Agent 2 -->
        <div class="agent-card">
            <img src="./uploads/images.png" alt="Agent Sarah" class="agent-photo">
            <h3>Sarah Johnson</h3>
            <p>Luxury Home Specialist</p>
            <p>12+ Years Experience</p>
            <button class="search-btn" onclick="openContactModal('Sarah Johnson', 'rozeena031@gmail.com')">Contact Agent</button>
        </div>
    </div>
</section>

<!-- Modal for Contact Form -->
<div id="contactModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeContactModal()">Ã—</span>
        <h2>Contact Agent</h2>
        <form id="contactForm">
            <input type="text" id="agentName" name="agentName" placeholder="Agent Name" readonly required>
            <input type="email" id="userEmail" name="userEmail" placeholder="Your Email" required>
            <textarea id="message" name="message" placeholder="Your Message" required></textarea>
            <button type="submit">Send Message</button>
        </form>
    </div>
</div>

<script>
    // Open the contact modal and pre-fill agent details
    function openContactModal(agentName, agentEmail) {
        document.getElementById('agentName').value = agentName;
        document.getElementById('contactModal').style.display = 'block';
    }

    // Close the contact modal
    function closeContactModal() {
        document.getElementById('contactModal').style.display = 'none';
    }

    // Handle the form submission
    document.getElementById('contactForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const agentName = document.getElementById('agentName').value;
        const userEmail = document.getElementById('userEmail').value;
        const message = document.getElementById('message').value;

        // Send the data to the server
        fetch('/contact-agent', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ agentName, userEmail, message })
        })
        .then(response => response.json())
        .then(data => {
            alert('Message sent to agent!');
            closeContactModal(); // Automatically close modal after sending the message
        })
        .catch(error => {
            alert('Failed to send message. Please try again.');
            console.error(error);  // Log the error to get more details
        });
    });
</script>

<style>
    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        overflow: auto;
    }

    .modal-content {
        background-color: white;
        margin: 10% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 50%;
        position: relative;
    }

    .close-btn {
        color: #aaa;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        top: 5px;
        right: 20px;
    }

    .close-btn:hover,
    .close-btn:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    /* Contact form styles */
    input, textarea {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }

    button {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
    }

    button:hover {
        background-color: #2980b9;
    }
</style>
